<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Tag on 小甲哥の垃圾工厂</title><link>https://www.wegod.cc/tags/tag/</link><description>Recent content in Tag on 小甲哥の垃圾工厂</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Tue, 22 Jul 2025 15:17:26 +0000</lastBuildDate><atom:link href="https://www.wegod.cc/tags/tag/index.xml" rel="self" type="application/rss+xml"/><item><title>机场/梯子推荐</title><link>https://www.wegod.cc/p/airport-recommend/</link><pubDate>Mon, 23 Dec 2024 09:24:13 +0800</pubDate><guid>https://www.wegod.cc/p/airport-recommend/</guid><description>&lt;img src="https://www.wegod.cc/p/airport-recommend/cover.jpg" alt="Featured image of post 机场/梯子推荐" />&lt;p>分类推荐，每种就推荐两三个，供有不同需求的人参考。&lt;/p>
&lt;p>极简总结：&lt;/p>
&lt;p>&lt;strong>优惠码适时更新，请关注：&lt;/strong>&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>🔥&lt;/th>
&lt;th>个人需求&lt;/th>
&lt;th>机场名称&lt;/th>
&lt;th>机场特点&lt;/th>
&lt;th>传送门&lt;/th>
&lt;th>优惠码&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>🔥&lt;/td>
&lt;td>高性价比，小众新兴&lt;/td>
&lt;td>五树云机场（原小米梯子）&lt;/td>
&lt;td>新兴机场，2.5G 速率，价格实惠，性价比高，值得一试&lt;/td>
&lt;td>&lt;a class="link" href="https://xminb.xiaomiaff.cc/register.html?invitecode=DBQFuexi" target="_blank" rel="noopener"
>🚀直达&lt;/a>&lt;/td>
&lt;td>9折：2025s9&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>🔥&lt;/td>
&lt;td>尝鲜偶用，预算较低&lt;/td>
&lt;td>一元机场&lt;/td>
&lt;td>一个月不到 1 块钱，老牌廉价机场，推荐作为备用防失联&lt;/td>
&lt;td>&lt;a class="link" href="https://xn--4gq62f52gdss.ink/#/register?code=QFTTlbYU" target="_blank" rel="noopener"
>🚀直达&lt;/a>&lt;/td>
&lt;td>-&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>🔥&lt;/td>
&lt;td>重度依赖，长期稳定&lt;/td>
&lt;td>TAG&lt;/td>
&lt;td>全球 250+ 节点、99+ 流媒体解锁，覆盖地区最广的机场，虽贵但好用&lt;/td>
&lt;td>&lt;a class="link" href="https://558343.dedicated-afflink.com/#/auth/2neqgxFl" target="_blank" rel="noopener"
>🚀直达&lt;/a>&lt;/td>
&lt;td>-&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>🔥&lt;/td>
&lt;td>喜欢看剧，自带Emby&lt;/td>
&lt;td>TLS&lt;/td>
&lt;td>主打 Emby， 有 4K 资源，支持直连和 Infuse，全球 50+ 节点&lt;/td>
&lt;td>&lt;a class="link" href="https://tls.wiki/index.php#/register?code=ojo2nVBG" target="_blank" rel="noopener"
>🚀直达&lt;/a>&lt;/td>
&lt;td>-&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>流媒体解锁都支持的。当前强烈推荐&lt;strong>五树云机场（原小米梯子）&lt;/strong>，稳定性好，性价比非常高！&lt;/p>
&lt;p>目录：&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="#%e7%89%b9%e5%88%ab%e6%8e%a8%e8%8d%90" >特别推荐&lt;/a>
&lt;ul>
&lt;li>&lt;a class="link" href="#%e4%ba%94%e6%a0%91%e4%ba%91%e6%9c%ba%e5%9c%ba%e5%8e%9f%e5%b0%8f%e7%b1%b3%e6%a2%af%e5%ad%90--%e6%80%a7%e4%bb%b7%e6%af%94%e8%87%b3%e9%ab%98%e4%b9%8b%e9%80%89" >🔥五树云机场（原小米梯子） —— 性价比至高之选&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a class="link" href="#%e8%bd%bb%e5%ba%a6%e4%bd%bf%e7%94%a8" >轻度使用&lt;/a>
&lt;ul>
&lt;li>&lt;a class="link" href="#%e4%b8%80%e5%85%83%e6%9c%ba%e5%9c%ba--%e4%b8%80%e4%b8%aa%e6%9c%881%e5%9d%97%e9%92%b1" >🔥一元机场 —— 一个月1块钱&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="#%e4%b8%89%e5%88%86%e6%9c%ba%e5%9c%ba--%e4%b8%80%e5%a4%a93%e5%88%86%e9%92%b1" >三分机场 —— 一天3分钱&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a class="link" href="#%e4%b8%ad%e5%ba%a6%e4%bd%bf%e7%94%a8" >中度使用&lt;/a>
&lt;ul>
&lt;li>&lt;a class="link" href="#%e5%b0%8f%e9%b8%a1%e5%bf%ab%e8%b7%91--%e4%bc%98%e8%b4%a8%e6%80%a7%e4%bb%b7%e6%af%94%e6%9c%ba%e5%9c%ba" >🔥小鸡快跑 —— 优质性价比机场&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a class="link" href="#%e9%87%8d%e5%ba%a6%e4%bd%bf%e7%94%a8" >重度使用&lt;/a>
&lt;ul>
&lt;li>&lt;a class="link" href="#tag--%e6%9c%ba%e5%9c%ba%e4%b8%ad%e7%9a%84%e6%8e%92%e5%a4%b4%e5%85%b5" >🔥TAG —— 机场中的排头兵&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="#nexitally--%e8%80%81%e7%89%8c%e6%9c%ba%e5%9c%ba%e4%bd%a9%e5%a5%87%e5%ae%b6%e5%a5%b6%e6%98%94" >Nexitally —— 老牌机场佩奇家、奶昔&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a class="link" href="#%e7%89%b9%e8%89%b2%e6%9c%ba%e5%9c%ba" >特色机场&lt;/a>
&lt;ul>
&lt;li>&lt;a class="link" href="#tls--emby-4k" >TLS —— Emby 4K&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a class="link" href="#%e6%9c%80%e5%90%8e" >最后&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="特别推荐">特别推荐
&lt;/h2>&lt;p>个人认为非常好用且性价比贼高的机场。&lt;/p>
&lt;h3 id="五树云机场原小米梯子--性价比至高之选">🔥五树云机场（原小米梯子） —— 性价比至高之选
&lt;/h3>&lt;p>9折优惠码：2025s9&lt;/p>
&lt;p>官网：&lt;a class="link" href="https://xminb.xiaomiaff.cc/register.html?invitecode=DBQFuexi" target="_blank" rel="noopener"
>👉链接🚀&lt;/a>&lt;/p>
&lt;p>协议：&lt;code>Trojan&lt;/code>&lt;/p>
&lt;p>特点：新兴的一家全中转 IPLC 翻墙机场，全节点 IPLC 专线，后端负载均衡、多种方式落地，2.5G速率，确保稳定性。不限速不限连接数！如果有特别需求，还可以私人定制。&lt;/p>
&lt;p>ChatGPT/OpenAI/TikTok 解锁，Netflix/Disney+/Youtube/PCR等常规流媒体已解锁。&lt;/p>
&lt;p>节点：香港、台湾、新加坡、日本、韩国、泰国、美国、法国、加拿大、马来西亚、英国、阿根廷、巴西等。&lt;/p>
&lt;p>价格适中，稳定性好，地区节点覆盖多。不限速不限连接数，适合多设备、全家共同使用。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/airport-recommend/wushuyun.jpg"
width="1470"
height="717"
srcset="https://www.wegod.cc/p/airport-recommend/wushuyun_hu_b45d677ada44422a.jpg 480w, https://www.wegod.cc/p/airport-recommend/wushuyun_hu_803531e233b19c32.jpg 1024w"
loading="lazy"
alt="五树云机场套餐"
class="gallery-image"
data-flex-grow="205"
data-flex-basis="492px"
>&lt;/p>
&lt;p>测速如下：&lt;/p>
&lt;p>机场尚在优化调整中，优化完成后都能跑满速，测速图暂做参考，后续会刷新。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/airport-recommend/xiaomitizi-speed.png"
width="2702"
height="3018"
srcset="https://www.wegod.cc/p/airport-recommend/xiaomitizi-speed_hu_ca6ffecd0bff3a03.png 480w, https://www.wegod.cc/p/airport-recommend/xiaomitizi-speed_hu_9a103a3d39f8054b.png 1024w"
loading="lazy"
alt="五树云机场测速"
class="gallery-image"
data-flex-grow="89"
data-flex-basis="214px"
>&lt;/p>
&lt;h2 id="轻度使用">轻度使用
&lt;/h2>&lt;ul>
&lt;li>&lt;strong>预算低&lt;/strong>，舍不得在这方面大支出&lt;/li>
&lt;li>备用机场防失联&lt;/li>
&lt;li>海淘、谷歌&lt;/li>
&lt;li>偶尔看看 Youtube 等视频&lt;/li>
&lt;li>Telegram 聊天&lt;/li>
&lt;li>基本没有速度和时延要求&lt;/li>
&lt;/ul>
&lt;h3 id="一元机场--一个月1块钱">🔥一元机场 —— 一个月1块钱
&lt;/h3>&lt;p>官网：&lt;a class="link" href="https://xn--4gq62f52gdss.ink/#/register?code=QFTTlbYU" target="_blank" rel="noopener"
>👉链接🚀&lt;/a>&lt;/p>
&lt;p>协议：&lt;code>Trojan&lt;/code>&lt;/p>
&lt;p>特点：廉价，流量高，速度还行，但是不太稳定。&lt;/p>
&lt;p>有点小名气的低价机场，主打的就是一个价格低。晚高峰会有点卡，稳定性也不算高，不过 12CNY/Year、20CNY/2Year 的价格要什么自行车，主要是速度也还行，解锁 Netflix 和 Disney+，美国节点解锁 ChatGPT。&lt;/p>
&lt;p>&lt;strong>注意:&lt;/strong> 传家宝套餐由原来每月 &lt;code>500G&lt;/code>，变成每月 &lt;code>50G&lt;/code> 了，此时可以优先考虑[三分机场](#三分机场 —— 一天3分钱)了~~&lt;/p>
&lt;p>他家就买这个传家宝套餐就行了。至于俩稍微贵点的高流量套餐，可以拿来当二道贩子，封装个 APP 卖钱😜。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/airport-recommend/one-dollar.jpg"
width="363"
height="538"
srcset="https://www.wegod.cc/p/airport-recommend/one-dollar_hu_eee0b8be80500c18.jpg 480w, https://www.wegod.cc/p/airport-recommend/one-dollar_hu_39a6843d0f48673f.jpg 1024w"
loading="lazy"
alt="一元机场套餐"
class="gallery-image"
data-flex-grow="67"
data-flex-basis="161px"
>&lt;/p>
&lt;p>节点以香港、日本、美国、新加坡为主，偶尔会出现土耳其等特别的节点。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/airport-recommend/one-dollar-speed.jpg"
width="2504"
height="2206"
srcset="https://www.wegod.cc/p/airport-recommend/one-dollar-speed_hu_39eb48af8d1fe584.jpg 480w, https://www.wegod.cc/p/airport-recommend/one-dollar-speed_hu_9ff8574a013a24cd.jpg 1024w"
loading="lazy"
alt="一元机场测速（来自网络）"
class="gallery-image"
data-flex-grow="113"
data-flex-basis="272px"
>&lt;/p>
&lt;h3 id="三分机场--一天3分钱">三分机场 —— 一天3分钱
&lt;/h3>&lt;p>优惠码（截止2025年04月05日，注意关注官网公告）：&lt;/p>
&lt;ul>
&lt;li>9折：&lt;del>neqatgho&lt;/del>&lt;/li>
&lt;/ul>
&lt;p>官网1：&lt;a class="link" href="https://panel.sanfen.icu/register?code=FKnu6Hkg" target="_blank" rel="noopener"
>👉链接（最新可直连）🚀&lt;/a>
官网2：&lt;a class="link" href="https://ca.sanfen.me/#/register?code=FKnu6Hkg" target="_blank" rel="noopener"
>👉链接🚀&lt;/a>
官网3：&lt;a class="link" href="https://hk.sanfen.cc/#/register?code=FKnu6Hkg" target="_blank" rel="noopener"
>👉链接🚀&lt;/a>&lt;/p>
&lt;p>协议：&lt;code>VMESS&lt;/code>&lt;/p>
&lt;p>&lt;strong>2024年6月5日起，限时供应 9.5CNY/Year 每月 200G 直连套餐！！！目前仍可购买。&lt;/strong>&lt;/p>
&lt;p>特点：廉价，流量较少，速度还行，稳定性一般，相对小众一点。&lt;/p>
&lt;p>和上面类似，也是靠低价起家的，后来也推出了中转套餐。&lt;/p>
&lt;p>注意：最实惠的套餐目前就是 &lt;code>8CNY/Quarter 每月 200G&lt;/code> 了。&lt;/p>
&lt;p>特别注意，直连套餐里有个小字说明：&lt;code>福建福州、泉州、湖南和河南大部分地区此套餐可能无法使&lt;/code>，这些地区的小伙伴谨慎购买。&lt;/p>
&lt;p>中转套餐就不太推荐了，最低 9.9CNY/Month 80G，这个价格的话更推荐上面的 &lt;a class="link" href="https://xminb.xiaomiaff.cc/register.html?invitecode=DBQFuexi" target="_blank" rel="noopener"
>五树云&lt;/a> 了。&lt;/p>
&lt;p>目前节点包括香港、日本、美国、新加坡、台湾。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/airport-recommend/three-cents-2.png"
width="1042"
height="1050"
srcset="https://www.wegod.cc/p/airport-recommend/three-cents-2_hu_20c688a440ec88e0.png 480w, https://www.wegod.cc/p/airport-recommend/three-cents-2_hu_de43d00503ee09b2.png 1024w"
loading="lazy"
alt="三分机场套餐2"
class="gallery-image"
data-flex-grow="99"
data-flex-basis="238px"
>&lt;/p>
&lt;p>官方频道测速如下：&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/airport-recommend/three-cents-speed.jpg"
width="1280"
height="531"
srcset="https://www.wegod.cc/p/airport-recommend/three-cents-speed_hu_d97f2f08d29e7ca1.jpg 480w, https://www.wegod.cc/p/airport-recommend/three-cents-speed_hu_6943eb4704816df8.jpg 1024w"
loading="lazy"
alt="三分机场测速"
class="gallery-image"
data-flex-grow="241"
data-flex-basis="578px"
>&lt;/p>
&lt;h2 id="中度使用">中度使用
&lt;/h2>&lt;ul>
&lt;li>&lt;strong>预算有限&lt;/strong>，愿意适当的为科学上网付费&lt;/li>
&lt;li>时不时看看 Youtube、Netflix、Disney+ 等流媒体&lt;/li>
&lt;li>Telegram 聊天，偶尔看看视频&lt;/li>
&lt;li>速度和时延不是特别敏感&lt;/li>
&lt;/ul>
&lt;h3 id="小鸡快跑--优质性价比机场">🔥小鸡快跑 —— 优质性价比机场
&lt;/h3>&lt;p>优惠码（截止2025年01月07日，注意关注官网公告）：&lt;/p>
&lt;ul>
&lt;li>&lt;del>月付套餐9折：20259&lt;/del>&lt;/li>
&lt;li>&lt;del>季付以上套餐8折：20258&lt;/del>&lt;/li>
&lt;li>&lt;del>60G年付套餐9折: 20259n&lt;/del>&lt;/li>
&lt;/ul>
&lt;p>官网：&lt;a class="link" href="https://ccv2.xiaojikp.pro/#/register?code=tqB3FCup" target="_blank" rel="noopener"
>👉链接🚀&lt;/a>&lt;/p>
&lt;p>官网2：&lt;a class="link" href="https://xiaojiv2.xiaojicf.com/#/register?invitecode=tqB3FCup" target="_blank" rel="noopener"
>👉链接🚀&lt;/a>&lt;/p>
&lt;p>协议：&lt;code>Trojan&lt;/code>&lt;/p>
&lt;p>特点：一家性价比翻墙机场，全节点 IPLC 专线，负载均衡，带宽冗余超过 2Gbps，测速最高能达 260MB/s，有不错的流媒体和 ChatGPT 解锁。&lt;/p>
&lt;p>相对小众一点，价格适中，与几个大机场相比可以说是低价，重点是速度超越绝大多数机场，值得一试。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/airport-recommend/chickenrun.jpg"
width="1682"
height="1062"
srcset="https://www.wegod.cc/p/airport-recommend/chickenrun_hu_96abff9219f85ba0.jpg 480w, https://www.wegod.cc/p/airport-recommend/chickenrun_hu_b8f4731e4d99c9fc.jpg 1024w"
loading="lazy"
alt="小鸡快跑套餐"
class="gallery-image"
data-flex-grow="158"
data-flex-basis="380px"
>&lt;/p>
&lt;p>测速如下：&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/airport-recommend/chickenrun-speed.jpg"
width="2616"
height="2844"
srcset="https://www.wegod.cc/p/airport-recommend/chickenrun-speed_hu_bbabcdfe19f33783.jpg 480w, https://www.wegod.cc/p/airport-recommend/chickenrun-speed_hu_9084520a64a9502d.jpg 1024w"
loading="lazy"
alt="小鸡快跑测速"
class="gallery-image"
data-flex-grow="91"
data-flex-basis="220px"
>&lt;/p>
&lt;h2 id="重度使用">重度使用
&lt;/h2>&lt;ul>
&lt;li>&lt;strong>不在乎价格&lt;/strong>&lt;/li>
&lt;li>Netflix、Disney+ 等流媒体重度依赖&lt;/li>
&lt;li>长期看不能直连的 Emby 公益服&lt;/li>
&lt;li>Telegram 上看视频&lt;/li>
&lt;li>办公强依赖&lt;/li>
&lt;li>追求&lt;strong>稳定性&lt;/strong>&lt;/li>
&lt;li>&lt;strong>高速&lt;/strong>和&lt;em>&lt;strong>低时延&lt;/strong>&lt;/em>要求&lt;/li>
&lt;/ul>
&lt;h3 id="tag--机场中的排头兵">🔥TAG —— 机场中的排头兵
&lt;/h3>&lt;p>官网：&lt;a class="link" href="https://558343.dedicated-afflink.com/#/auth/2neqgxFl" target="_blank" rel="noopener"
>👉链接🚀&lt;/a>&lt;/p>
&lt;p>协议：&lt;code>Shadowsocks&lt;/code>&lt;/p>
&lt;p>特点：比较贵，节点覆盖面广，速度较快，稳定。有&lt;strong>游戏专用节点&lt;/strong>，游戏加速效果不错。&lt;/p>
&lt;p>&lt;strong>特别提醒：该机场禁用了 22 端口，这点对开发者不太友好，尤其影响 Git SSH，如果你是开发者则慎重购买。&lt;/strong>&lt;/p>
&lt;p>全球 250+ 节点、99+ 流媒体解锁，线路是全 BGP-IEPL 广港 + BGP-IEPL 沪日中转，全球 90+ 国家地区节点，&lt;strong>地区覆盖范围是最广的&lt;/strong>，什么奇奇怪怪的国家地区都有，就连南极、美国星链也有。想象以下，发帖回帖，地区显示南极😁！&lt;/p>
&lt;p>同样的 Netflix、Disney+ 等流媒体，该解锁的都解锁了，ChatGPT 也是。&lt;/p>
&lt;p>他家有一个特别套餐，154CNY/Year，总共 200G 流量，用作备用防失联特别好，或者需要一些罕见地区的时候。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/airport-recommend/tag-sp.png"
width="348"
height="572"
srcset="https://www.wegod.cc/p/airport-recommend/tag-sp_hu_ce851ee91625ecfe.png 480w, https://www.wegod.cc/p/airport-recommend/tag-sp_hu_5e29e57f01515959.png 1024w"
loading="lazy"
alt="TAG 特殊套餐"
class="gallery-image"
data-flex-grow="60"
data-flex-basis="146px"
>&lt;/p>
&lt;p>其他套餐价格如下：&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/airport-recommend/tag.png"
width="2211"
height="1167"
srcset="https://www.wegod.cc/p/airport-recommend/tag_hu_d0a38476185d484c.png 480w, https://www.wegod.cc/p/airport-recommend/tag_hu_dde18d917cdf91ff.png 1024w"
loading="lazy"
alt="TAG套餐"
class="gallery-image"
data-flex-grow="189"
data-flex-basis="454px"
>&lt;/p>
&lt;p>电信测速，可以参考下。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/airport-recommend/tag-speed.png"
width="4591"
height="15256"
srcset="https://www.wegod.cc/p/airport-recommend/tag-speed_hu_dece172addffdc41.png 480w, https://www.wegod.cc/p/airport-recommend/tag-speed_hu_807007f8bff67d70.png 1024w"
loading="lazy"
alt="TAG测速"
class="gallery-image"
data-flex-grow="30"
data-flex-basis="72px"
>&lt;/p>
&lt;h3 id="nexitally--老牌机场佩奇家奶昔">Nexitally —— 老牌机场佩奇家、奶昔
&lt;/h3>&lt;p>官网：&lt;a class="link" href="https://naiixi.com/signupbyemail.aspx?MemberCode=5753cb7ae8b241a0bf7a55ae3330f8bc20210411040001" target="_blank" rel="noopener"
>👉链接🚀&lt;/a>&lt;/p>
&lt;p>协议：&lt;code>Shadowsocks&lt;/code>, &lt;code>Trojan&lt;/code>&lt;/p>
&lt;p>特点：昂贵，稳定，流量还行，速度快，晚高峰也稳定有速度。出问题的时候，也是自己把自己折腾挂了。&lt;/p>
&lt;p>官网打不开的话先挂个别的代理。&lt;/p>
&lt;p>&lt;a class="link" href="https://www.duyaoss.com/" target="_blank" rel="noopener"
>毒药&lt;/a>推荐中的第一名，佩奇家中转线路的高端机场，稳定性和速度都非常错，价格高昂，但是对于追求稳定性的用户也还能接受。&lt;/p>
&lt;p>这也是我个人主要使用的，已经使用三年了，目前应该是第四年。&lt;/p>
&lt;p>Netflix、Disney+ 等流媒体，该解锁的都解锁了，ChatGPT 也是可以正常用的。&lt;/p>
&lt;p>有自己的傻瓜客户端，可以登录后一键连接。&lt;/p>
&lt;p>套餐情况：&lt;/p>
&lt;ul>
&lt;li>Smart Access：每月 500G 流量，价格受汇率影响，约为 117CNY/Month，约 594CNY/Year，约 1102CNY/Year&lt;/li>
&lt;li>Smart Access Air：每月 200G 流量，价格是 Smart Access 的一半多点，但是&lt;code>限量提供，能不能买到看缘分，买到后可以一直续费&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://www.wegod.cc/p/airport-recommend/nexitally.png"
width="1537"
height="896"
srcset="https://www.wegod.cc/p/airport-recommend/nexitally_hu_83fc2fc7e70e1fc3.png 480w, https://www.wegod.cc/p/airport-recommend/nexitally_hu_ba48c8b545354114.png 1024w"
loading="lazy"
alt="Nexitally 套餐"
class="gallery-image"
data-flex-grow="171"
data-flex-basis="411px"
>&lt;/p>
&lt;p>毒药的电信测速，可以参考下。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/airport-recommend/nexitally-speed.png"
width="4490"
height="8238"
srcset="https://www.wegod.cc/p/airport-recommend/nexitally-speed_hu_508cd386aeed7890.png 480w, https://www.wegod.cc/p/airport-recommend/nexitally-speed_hu_fc1bf25e496d414b.png 1024w"
loading="lazy"
alt="Nexitally 测速（来自毒药）"
class="gallery-image"
data-flex-grow="54"
data-flex-basis="130px"
>&lt;/p>
&lt;h2 id="特色机场">特色机场
&lt;/h2>&lt;p>这类机场除了提供科学上网的节点之外，一般还附带一些别的服务，例如 Emby、Plex 之类的视频服务。&lt;/p>
&lt;h3 id="tls--emby-4k">TLS —— Emby 4K
&lt;/h3>&lt;ul>
&lt;li>&lt;del>全场8折优惠码：2025GO&lt;/del>&lt;/li>
&lt;/ul>
&lt;p>官网：&lt;a class="link" href="https://tls.wiki/index.php#/register?code=ojo2nVBG" target="_blank" rel="noopener"
>👉链接🚀&lt;/a>&lt;/p>
&lt;p>协议：&lt;code>Shadowsocks&lt;/code>&lt;/p>
&lt;p>特点：中高级套餐附带 Emby 且有 4K，价格适中，速度较快，相对稳定。&lt;code>PS: Emby 高清和4K均已恢复，可以冲！······&lt;/code>&lt;/p>
&lt;p>最大的特色是高级套餐附带 Emby 服务，提供了 4K 片源，并且直连 Emby 的速度也是不错的，不需要梯子就能直接看。影视库更新速度也挺快，最新电视剧集基本第二天就上了，基本可以替代国内视频平台。相对小众一点，客服态度也很好。&lt;/p>
&lt;p>套餐除了翻墙套餐送 Emby 外，也单独提供了 Emby 套餐。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/airport-recommend/tls.png"
width="2025"
height="1316"
srcset="https://www.wegod.cc/p/airport-recommend/tls_hu_3a7b488858e40e5c.png 480w, https://www.wegod.cc/p/airport-recommend/tls_hu_9736ce16759d1e01.png 1024w"
loading="lazy"
alt="TLS 套餐"
class="gallery-image"
data-flex-grow="153"
data-flex-basis="369px"
>&lt;/p>
&lt;p>测速如下：&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/airport-recommend/tls-speed.png"
width="3212"
height="4062"
srcset="https://www.wegod.cc/p/airport-recommend/tls-speed_hu_696e286924af33e4.png 480w, https://www.wegod.cc/p/airport-recommend/tls-speed_hu_6664a604b4696584.png 1024w"
loading="lazy"
alt="TLS 测速（来自网络）"
class="gallery-image"
data-flex-grow="79"
data-flex-basis="189px"
>&lt;/p>
&lt;h2 id="最后">最后
&lt;/h2>&lt;p>对于刚接触科学上网的朋友，建议先买个廉价的梯子体验个把月，确认自己是否有科学上网的需求、以及科学上网的依赖度有多大，如果确实有需求再考虑换高价稳定的梯子。&lt;/p>
&lt;p>对于海淘的朋友，如果只看看商品不亲自购买，一元机场、三分机场这种完全够用，别信海淘群里那种倒卖的，说不定卖给你的就是这种。&lt;/p></description></item><item><title>AdGuardHome + mosdns + openclash 打造自由的家庭/办公室网络</title><link>https://www.wegod.cc/p/fuck-gfw/</link><pubDate>Sat, 25 Nov 2023 20:32:18 +0800</pubDate><guid>https://www.wegod.cc/p/fuck-gfw/</guid><description>&lt;img src="https://www.wegod.cc/p/fuck-gfw/cover.jpg" alt="Featured image of post AdGuardHome + mosdns + openclash 打造自由的家庭/办公室网络" />&lt;p>🔥🔥🔥：稳定好用的机场/梯子 &lt;a class="link" href="https://558343.dedicated-afflink.com/#/auth/2neqgxFl" target="_blank" rel="noopener"
>TAG 全球250+节点、99+流媒体解锁&lt;/a>，更多参考&lt;a class="link" href="https://www.wegod.cc/p/airport-recommend/" >机场推荐&lt;/a>&lt;/p>
&lt;hr>
&lt;p>👉 首先推广下自己编译的 OpenWrt &lt;strong>旁路由极简版&lt;/strong>，专为&lt;strong>旁路由&lt;/strong>而制作。 👍👍👍&lt;/p>
&lt;ul>
&lt;li>编译脚本以及个人修改的组件依赖全开源，Github Actions 在线编译，安全可靠无后门。&lt;/li>
&lt;li>基于 &lt;a class="link" href="https://github.com/coolsnowwolf/lede" target="_blank" rel="noopener"
>lede&lt;/a> 源码&lt;/li>
&lt;li>默认配置 DHCPv6 Client 接口 lan6。&lt;/li>
&lt;li>默认配置好了 AdGuardHome 、 mosdns 和 openclash （或 ssrp ）的搭配运行配置。&lt;/li>
&lt;li>openclash 预置 clash_meta 内核。&lt;/li>
&lt;li>mosdns 使用了 &lt;a class="link" href="https://github.com/alecthw/mosdns" target="_blank" rel="noopener"
>自己的修改版&lt;/a>，支持 MMDB GeoIP 匹配。&lt;/li>
&lt;/ul>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>版本&lt;/th>
&lt;th>说明&lt;/th>
&lt;th style="text-align: center">下载地址&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>x86&lt;/td>
&lt;td>包含 ssrp 和 openclash，&lt;a class="link" href="https://github.com/alecthw/openwrt-actions/blob/master/user/lede-common-x86-amd64/README.md" target="_blank" rel="noopener"
>详细说明&lt;/a>&lt;/td>
&lt;td style="text-align: center">&lt;a class="link" href="https://github.com/alecthw/openwrt-actions/releases/tag/lede-common-x86-amd64" target="_blank" rel="noopener"
>下载&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>x86 openclash 专版&lt;/td>
&lt;td>仅包含 openclash，注意此固件默认不劫持 53 端口，&lt;a class="link" href="https://github.com/alecthw/openwrt-actions/blob/master/user/lede-openclash-x86-amd64/README.md" target="_blank" rel="noopener"
>详细说明&lt;/a>&lt;/td>
&lt;td style="text-align: center">&lt;a class="link" href="https://github.com/alecthw/openwrt-actions/releases/tag/lede-openclash-x86-amd64" target="_blank" rel="noopener"
>下载&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>r2s&lt;/td>
&lt;td>包含 ssrp 和 openclash，&lt;a class="link" href="https://github.com/alecthw/openwrt-actions/blob/master/user/lede-common-r2s-arm64/README.md" target="_blank" rel="noopener"
>详细说明&lt;/a>&lt;/td>
&lt;td style="text-align: center">&lt;a class="link" href="https://github.com/alecthw/openwrt-actions/releases/tag/lede-common-r2s-arm64" target="_blank" rel="noopener"
>下载&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>n1&lt;/td>
&lt;td>包含 ssrp 和 openclash，&lt;a class="link" href="https://github.com/alecthw/openwrt-actions/blob/master/user/lede-common-n1-arm64/README.md" target="_blank" rel="noopener"
>详细说明&lt;/a>&lt;/td>
&lt;td style="text-align: center">&lt;a class="link" href="https://github.com/alecthw/openwrt-actions/releases/tag/lede-common-n1-arm64" target="_blank" rel="noopener"
>下载&lt;/a>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>&lt;strong>注意，旁路由固件默认未开启DHCP，旁路由固件默认未开启DHCP，旁路由固件默认未开启DHCP！&lt;/strong>&lt;/p>
&lt;p>&lt;strong>所以，如果不在控制台修改IP，请修改电脑的IP访问，然后可以在网页修改。&lt;/strong>&lt;/p>
&lt;h2 id="前言">前言
&lt;/h2>&lt;p>CN网络的阻断方式主要有两个部分：&lt;/p>
&lt;ul>
&lt;li>GFW 阻断&lt;/li>
&lt;li>DNS 污染&lt;/li>
&lt;/ul>
&lt;p>GFW 阻断就是我们常说的&lt;code>被墙了&lt;/code>，即使是DNS没有被污染，也无法访问到。&lt;/p>
&lt;p>DNS 污染即让你访问网站时，无法获得域名对应的IP地址，从而导致无法访问到网站。DNS 污染在移动宽带中尤为典型，即使自定义了DNS 服务器，也会被拦截污染。&lt;/p>
&lt;p>要实现科学上网，必须同时解决&lt;code>GFW 阻断&lt;/code>和&lt;code>DNS 污染&lt;/code>，并且两者配合以提高网络访问体验。&lt;/p>
&lt;p>代理中的DNS知识，可以参考 Sukka 的这篇文章&lt;a class="link" href="https://blog.skk.moe/post/what-happend-to-dns-in-proxy/" target="_blank" rel="noopener"
>《浅谈在代理环境中的 DNS 解析行为》&lt;/a>&lt;/p>
&lt;h3 id="路由器科学上网和终端科学上网的区别">路由器科学上网和终端科学上网的区别
&lt;/h3>&lt;p>路由器上配置透明代理，和在终端PC上直接通过客户端，最主要的区别是 DNS 解析。&lt;/p>
&lt;h4 id="pc终端上">PC终端上
&lt;/h4>&lt;p>通常有以下几个步骤&lt;/p>
&lt;ol>
&lt;li>启动客户端&lt;/li>
&lt;li>选择全局/规则模式&lt;/li>
&lt;li>配置系统代理（一般客户端自动配置），把科学上网客户端作为系统代理的上游代理服务器&lt;/li>
&lt;/ol>
&lt;p>第3步里的配置系统代理，通常有&lt;code>http&lt;/code>和&lt;code>sock5&lt;/code>两种。&lt;/p>
&lt;p>此时，打开浏览器访问一个网站：&lt;/p>
&lt;p>当使用&lt;code>http&lt;/code>代理时，浏览器不会在本地进行 DNS 解析，请求的域名会作为 http 报文的一部分直接发给代理服务器（科学上网客户端），DNS 完全在代理服务器（科学上网客户端）上处理。&lt;/p>
&lt;p>当使用&lt;code>sock5&lt;/code>代理时，&lt;code>sock5&lt;/code>支持UDP，DNS 解析会封装在&lt;code>sock5&lt;/code>之中，发给代理服务器（科学上网客户端）处理，浏览器拿到 IP 地址后，在发起连接。&lt;/p>
&lt;h4 id="路由器上配置透明代理">路由器上配置透明代理
&lt;/h4>&lt;p>此时，科学上网客户端运行在路由器上，PC 终端是看不见代理的，所以叫透明代理。PC 终端上，请求的发起的流程照旧，先进行 DNS 解析，拿到 IP 后再发起请求。&lt;/p>
&lt;p>在这种情况下，对于路由器上运行的科学上网客户端来说，域名和 IP 是两个请求，有的会内置 Mapping 机制（例如 Clash），用来还原 IP 到域名。&lt;/p>
&lt;p>这种情况下，优惠DNS配置就相对比较重要了，否则针对部署的CDN的网站不能做到最优访问。&lt;/p>
&lt;h2 id="正文开始配置--dns-优化">正文开始：配置 &amp;amp; DNS 优化
&lt;/h2>&lt;p>本文主要考虑的是自由的局域网环境，所以只介绍路由器上科学上网配置。&lt;/p>
&lt;p>首先分析下要实现的目标：&lt;/p>
&lt;ul>
&lt;li>双栈网络
&lt;ul>
&lt;li>国内网络使用 IPV4 &amp;amp; IPV6 双栈&lt;/li>
&lt;li>科学上网仅使用 IPV4&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>国内外分流&lt;/li>
&lt;li>DNS分流
&lt;ul>
&lt;li>国内域名由国内 DNS 服务器解析&lt;/li>
&lt;li>国外域名经过代理由国外 DNS 服务器&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="国内外和应用分流">国内外和应用分流
&lt;/h3>&lt;p>这个没啥好多说的，按文档配置规则就行。也可参考文末给出的示例配置。&lt;/p>
&lt;h3 id="dns-优化目标">DNS 优化目标
&lt;/h3>&lt;ul>
&lt;li>广告过滤：使用 AdGuardHome&lt;/li>
&lt;li>DNS分流：使用 mosdns
&lt;ul>
&lt;li>其中，境外网站屏蔽 IPV6 应答&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>如果使用 openclash，DNS 必须经过 clash 内核，以使 DNS 完成 IP &amp;lt;&amp;ndash;&amp;gt; Domain 的 mapping&lt;/li>
&lt;/ul>
&lt;p>PS: mosdns 使用 &lt;a class="link" href="https://github.com/alecthw/mosdns" target="_blank" rel="noopener"
>alecthw 修改版&lt;/a>，支持 MMDB GeoIP 匹配&lt;/p>
&lt;h3 id="多级-dns-级联">多级 DNS 级联
&lt;/h3>&lt;pre class="mermaid">flowchart LR
A[AdGuardHome, Port 53, no cache] -- 主要 --&amp;gt; B[openclash, Port 7874]
B --&amp;gt; C[mosdns, Port 5335]
A -- 备用\n防止 openclash 为运行时网络无法访问 --&amp;gt; C&lt;/pre>
&lt;p>配置过程如下：&lt;/p>
&lt;ul>
&lt;li>修改了 dnsmasq 的默认端口号，用 AdGuardHome 监听53端口作为默认的DNS解析。&lt;/li>
&lt;li>AdGuardHome 可以监控的各个终端的 DNS 请求，并使用广告过滤和管控功能。&lt;/li>
&lt;li>openclash 作为 AdGuardHome 的上游。&lt;/li>
&lt;li>mosdns 作为 AdGuardHome 的上游备用服务器。&lt;/li>
&lt;li>openclash 中&lt;code>本地 DNS 劫持&lt;/code>设置为&lt;code>停用&lt;/code>，当 openclash 运行时，openclash 作为 AdGuardHome 的上游主要服务器&lt;code>生效&lt;/code>。&lt;/li>
&lt;li>openclash 复写设置中，启用自定义上游 DNS 服务器，并指定 mosdns 为唯一上游。&lt;/li>
&lt;/ul>
&lt;p>如此一来，最终的 DNS 请求由 mosdns 发出，请求会经过 openclash 分流，按请求的 DNS 服务器直连或走代理。DNS 请求整个流程如下：&lt;/p>
&lt;pre class="mermaid">flowchart TB
A((电脑/手机\n浏览器)) -- DNS 请求 --&amp;gt; B[路由器\nAdGuardHome]
B --&amp;gt; C[路由器\nopenclash DNS]
C --&amp;gt; D[路由器\nmosdns]
D --&amp;gt; E[路由器\nopenclash Proxy Client]
E -- 国外 DNS 服务器\n屏蔽ipv6应答 --&amp;gt; F[服务器\nProxy Server]
E -- 国内 DNS 服务器 --&amp;gt; N(Internet)
F --&amp;gt; N&lt;/pre>
&lt;p>如此，便实现了&lt;/p>
&lt;ul>
&lt;li>AdGuardHome 的管控和广告过滤&lt;/li>
&lt;li>mosdns 分流 DNS，并屏蔽非中国大陆 IP 的 IPV6 应答&lt;/li>
&lt;li>DNS 经过 clash 内核，迎合其 mapping 机制&lt;/li>
&lt;/ul>
&lt;h3 id="配置示例">配置示例
&lt;/h3>&lt;p>👍 再次提醒，文章开始处的固件，所有配置已内置哦！&lt;/p>
&lt;h4 id="dnsmasq">dnsmasq
&lt;/h4>&lt;p>&lt;img src="https://www.wegod.cc/p/fuck-gfw/dnsmasq.png"
width="1453"
height="84"
srcset="https://www.wegod.cc/p/fuck-gfw/dnsmasq_hu_55e25a4cd64de615.png 480w, https://www.wegod.cc/p/fuck-gfw/dnsmasq_hu_10009cc241eca1f6.png 1024w"
loading="lazy"
alt="dnsmasq"
class="gallery-image"
data-flex-grow="1729"
data-flex-basis="4151px"
>&lt;/p>
&lt;h4 id="adguardhome">AdGuardHome
&lt;/h4>&lt;p>&lt;img src="https://www.wegod.cc/p/fuck-gfw/adguardhome_1.png"
width="1424"
height="197"
srcset="https://www.wegod.cc/p/fuck-gfw/adguardhome_1_hu_2cf26687e88d5e37.png 480w, https://www.wegod.cc/p/fuck-gfw/adguardhome_1_hu_8397c7c813616ae1.png 1024w"
loading="lazy"
alt="adguardhome_1"
class="gallery-image"
data-flex-grow="722"
data-flex-basis="1734px"
>&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/fuck-gfw/adguardhome_2.png"
width="1427"
height="440"
srcset="https://www.wegod.cc/p/fuck-gfw/adguardhome_2_hu_bd4ea69b47c86176.png 480w, https://www.wegod.cc/p/fuck-gfw/adguardhome_2_hu_55cebf092f58ccb2.png 1024w"
loading="lazy"
alt="adguardhome_2"
class="gallery-image"
data-flex-grow="324"
data-flex-basis="778px"
>&lt;/p>
&lt;h4 id="openclash">openclash
&lt;/h4>&lt;p>&lt;img src="https://www.wegod.cc/p/fuck-gfw/openclash_1.png"
width="1731"
height="246"
srcset="https://www.wegod.cc/p/fuck-gfw/openclash_1_hu_4f39d226cd74ea6d.png 480w, https://www.wegod.cc/p/fuck-gfw/openclash_1_hu_94961e8467752b8b.png 1024w"
loading="lazy"
alt="openclash_1"
class="gallery-image"
data-flex-grow="703"
data-flex-basis="1688px"
>&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/fuck-gfw/openclash_2.png"
width="1745"
height="293"
srcset="https://www.wegod.cc/p/fuck-gfw/openclash_2_hu_8457efb58deb5623.png 480w, https://www.wegod.cc/p/fuck-gfw/openclash_2_hu_6889f5779b2dcd9a.png 1024w"
loading="lazy"
alt="openclash_2"
class="gallery-image"
data-flex-grow="595"
data-flex-basis="1429px"
>&lt;/p>
&lt;p>注意删除默认的DNS配置，仅保留这一个即可。&lt;/p>
&lt;h4 id="mosdns">mosdns
&lt;/h4>&lt;p>使用自定义配置，由于使用了 mmdb geoip 匹配，mosdns 必须使用 &lt;a class="link" href="https://github.com/alecthw/mosdns" target="_blank" rel="noopener"
>alecthw 修改版&lt;/a>。&lt;/p>
&lt;p>PS: 以下配置中的 &lt;a class="link" href="https://github.com/alecthw/chnlist/blob/release/mosdns/whitelist.list" target="_blank" rel="noopener"
>cn-white.txt&lt;/a>，来自项目 &lt;a class="link" href="https://github.com/alecthw/chnlist" target="_blank" rel="noopener"
>chnlist&lt;/a>，我编译的固件已内置并设置自动更新，其他固件需要手动下载。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;span class="lnt">107
&lt;/span>&lt;span class="lnt">108
&lt;/span>&lt;span class="lnt">109
&lt;/span>&lt;span class="lnt">110
&lt;/span>&lt;span class="lnt">111
&lt;/span>&lt;span class="lnt">112
&lt;/span>&lt;span class="lnt">113
&lt;/span>&lt;span class="lnt">114
&lt;/span>&lt;span class="lnt">115
&lt;/span>&lt;span class="lnt">116
&lt;/span>&lt;span class="lnt">117
&lt;/span>&lt;span class="lnt">118
&lt;/span>&lt;span class="lnt">119
&lt;/span>&lt;span class="lnt">120
&lt;/span>&lt;span class="lnt">121
&lt;/span>&lt;span class="lnt">122
&lt;/span>&lt;span class="lnt">123
&lt;/span>&lt;span class="lnt">124
&lt;/span>&lt;span class="lnt">125
&lt;/span>&lt;span class="lnt">126
&lt;/span>&lt;span class="lnt">127
&lt;/span>&lt;span class="lnt">128
&lt;/span>&lt;span class="lnt">129
&lt;/span>&lt;span class="lnt">130
&lt;/span>&lt;span class="lnt">131
&lt;/span>&lt;span class="lnt">132
&lt;/span>&lt;span class="lnt">133
&lt;/span>&lt;span class="lnt">134
&lt;/span>&lt;span class="lnt">135
&lt;/span>&lt;span class="lnt">136
&lt;/span>&lt;span class="lnt">137
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># 白名单模式&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="c"># 白名单 或 境外查询IP是geoip:CN，走国内&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">log&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">level&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">info&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">file&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/tmp/mosdns.log&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">plugins&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># mmdb&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">country&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">mmdb&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">file&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/etc/mosdns/rule/Country.mmdb&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># cn ip&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">whitelist&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">domain_set&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">files&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;/etc/mosdns/rule/cn-white.txt&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># 广告域名列表 geosite:category-ads-all&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">geosite_ads&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">domain_set&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">files&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;/etc/mosdns/rule/reject-list.txt&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># hosts&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">hosts&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">hosts&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">entries&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;localhost 127.0.0.1&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># 缓存&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">cache&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">cache&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">size&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">20480&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">lazy_cache_ttl&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">86400&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">dump_file&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/etc/mosdns/cache.dump&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">dump_interval&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">1800&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># 查询境外DNS&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">forward_global&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">forward&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">concurrent&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">3&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">upstreams&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Google_dot&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">addr&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;tls://8.8.4.4&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">enable_pipeline&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Quad9_dot&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">addr&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;tls://9.9.9.9&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">enable_pipeline&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Cloudflare_dot&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">addr&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;tls://1.0.0.1&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">enable_pipeline&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">OpenDNS_dot&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">addr&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;tls://208.67.222.222&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">enable_pipeline&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># 查询国内DNS&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">forward_china&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">forward&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">concurrent&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">upstreams&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Ali_dot&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">addr&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;tls://223.5.5.5&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">enable_pipeline&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">DNSPod_dot&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">addr&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;tls://120.53.53.53&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">enable_pipeline&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># 境外解析，优先IPV4&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">global_sequence&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">sequence&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">matches&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">qname $whitelist&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">exec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">return&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">exec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">prefer_ipv4&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">exec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">$forward_global&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">matches&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">resp_ip_mmdb $country CN&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">exec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">drop_resp&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># 国内解析，不设置过滤，作为fallback&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">china_sequence&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">sequence&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">exec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">$forward_china&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># 屏蔽解析&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">reject_sequence&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">sequence&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">matches&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">qname $geosite_ads&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">exec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">reject 3&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">matches&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">qtype 12&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">exec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">reject 3&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># - matches: qtype 65&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># exec: reject 3&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># 如果 primary 抛出错误，或返回但没有应答，或在 threshold 毫秒内无响应，则执行 secondary。&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># 所以在 primary 中不能用 rejcet，reject 也是应答&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># Fallback&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">fallback&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">fallback&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">primary&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">global_sequence&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">secondary&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">china_sequence&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">threshold&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">150&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">always_standby&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">main_sequence&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">sequence&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">exec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">$reject_sequence&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">exec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">$hosts&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">matches&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">has_resp&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">exec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">accept&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">exec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">$cache&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">matches&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">has_resp&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">exec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">accept&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">exec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">$fallback&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">matches&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">has_resp&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">exec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ttl 10-600&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">tag&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">udp_server&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">udp_server&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">entry&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">main_sequence&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">listen&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">0.0.0.0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">5335&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="防火墙劫持-53-端口可选">防火墙，劫持 53 端口（可选）
&lt;/h4>&lt;p>防止客户端自定义 DNS 服务器，从而绕过管控，可以在防火墙自定义规则配置劫持 53 端口 UDP 和 UDP。&lt;/p>
&lt;p>但是，如果客户端配置加密 DNS 就没法劫持。如果要限制，对于 DoT 和 DoQ 可以屏蔽 853 端口禁用，但是 DoH 就完全没办法。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 同时支持 iptables 和 ip6tables&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dns_redirect&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">cmd&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;-t nat -A PREROUTING -p &lt;/span>&lt;span class="nv">$1&lt;/span>&lt;span class="s2"> --dport 53 -j REDIRECT --to-ports 53&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">chk&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="k">$(&lt;/span>&lt;span class="nb">echo&lt;/span> &lt;span class="nv">$cmd&lt;/span> &lt;span class="p">|&lt;/span> sed -e &lt;span class="s1">&amp;#39;s/-A/-C/g&amp;#39;&lt;/span>&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="nv">$cmd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="nv">$chk&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$2&lt;/span> &lt;span class="nv">$chk&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">ret&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$?&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$ret&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> -ne &lt;span class="m">0&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">$2&lt;/span> &lt;span class="nv">$cmd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dns_redirect udp iptables
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dns_redirect tcp iptables
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span> -n &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>&lt;span class="nb">command&lt;/span> -v ip6tables&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> dns_redirect udp ip6tables
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span> -n &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>&lt;span class="nb">command&lt;/span> -v ip6tables&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> dns_redirect tcp ip6tables
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="作为主路由时使用的特别说明">作为主路由时使用的特别说明
&lt;/h2>&lt;h3 id="主路由-dhcp-服务器">主路由 DHCP 服务器
&lt;/h3>&lt;p>DHCP 服务器设置中的 DNS 服务器，务必设置成旁路由，不要设置公共 DNS。&lt;/p>
&lt;h3 id="主路由-ipv6">主路由 IPv6
&lt;/h3>&lt;ol>
&lt;li>不通告 IPv6 DNS 服务器，DNS 解析全部走 IPv4。&lt;/li>
&lt;li>通告 DNS 服务器为路由器自己，即路由器的链路本地地址。&lt;/li>
&lt;/ol>
&lt;h2 id="作为旁路由时使用的特别说明">作为旁路由时使用的特别说明
&lt;/h2>&lt;h3 id="旁路由-dhcp-服务器">旁路由 DHCP 服务器
&lt;/h3>&lt;p>一般情况下建议禁用旁路由 DHCP 服务器，在主路由配置 DHCP 服务器，把网关设置成旁路由，或者通过静态分配指定不同客户端指向不同网关。&lt;/p>
&lt;p>DHCP 服务器设置中的 DNS 服务器，务必设置成旁路由，不要设置公共 DNS。&lt;/p>
&lt;h3 id="旁路由-ipv6">旁路由 IPv6
&lt;/h3>&lt;p>主路由上请勿通告 IPv6 DNS 服务器（这里指 IPv6 地址的 DNS 服务器，如 2400:3200::1）。通过 IPv4 地址的 DNS 服务器解析域名，一样可以拿到 AAAA 记录，所以没必要开启 IPv6 地址的 DNS 服务器，开启反而会增加配置难度，影响 DNS 分流，并可能造成 DNS 泄露。&lt;/p>
&lt;p>如下查询示例，可以看到，通过 IPv4 DNS 服务器可以获得 IPv6 地址。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$ nslookup www.iqiyi.com 223.5.5.5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Server: 223.5.5.5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Address: 223.5.5.5#53
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Non-authoritative answer:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">www.iqiyi.com canonical &lt;span class="nv">name&lt;/span> &lt;span class="o">=&lt;/span> ipv6-static.dns.iqiyi.com.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Name: ipv6-static.dns.iqiyi.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Address: 101.227.12.45
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Name: ipv6-static.dns.iqiyi.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Address: 101.227.12.41
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Name: ipv6-static.dns.iqiyi.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Address: 240e:e1:a400:1c::22
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Name: ipv6-static.dns.iqiyi.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Address: 240e:e1:a400:1c::21
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Openwrt、iKuai、RouterOS 都是支持不通告 IPv6 DNS 的。如果你的主路由不支持，IPv6 DNS 可以填个无效地址，如 &lt;code>::1&lt;/code>。&lt;/p></description></item><item><title>手把手教你科学上网 —— 手机篇（sing-box）</title><link>https://www.wegod.cc/p/singbox-help-mobile/</link><pubDate>Fri, 18 Oct 2024 10:16:19 +0800</pubDate><guid>https://www.wegod.cc/p/singbox-help-mobile/</guid><description>&lt;img src="https://www.wegod.cc/p/singbox-help-mobile/cover.png" alt="Featured image of post 手把手教你科学上网 —— 手机篇（sing-box）" />&lt;h2 id="手机科学上网需要些什么">手机科学上网需要些什么
&lt;/h2>&lt;ul>
&lt;li>一部手机（废话）&lt;/li>
&lt;li>机场/梯子，术语叫代理、VPN，推荐购买 &lt;a class="link" href="https://xminb.xiaomiaff.cc/register.html?invitecode=DBQFuexi" target="_blank" rel="noopener"
>五树云机场（原小米梯子）&lt;/a> 或 &lt;a class="link" href="https://ccv2.xiaojikp.pro/#/register?code=tqB3FCup" target="_blank" rel="noopener"
>小鸡快跑&lt;/a>&lt;/li>
&lt;li>客户端软件，文中使用 &lt;a class="link" href="https://github.com/SagerNet/sing-box" target="_blank" rel="noopener"
>sing-box&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>打个比喻，客户端软件是车，机场/梯子是路，两个都有了才能跑。&lt;/p>
&lt;h2 id="说在前面">说在前面
&lt;/h2>&lt;ol>
&lt;li>机场/梯子肯定是要花钱买的！这里给你推荐，但不售卖。&lt;/li>
&lt;li>Apple iOS 端安装需要外区账号，如果你没本事注册，就花几块钱买，后面会推荐购买平台。&lt;/li>
&lt;/ol>
&lt;h2 id="具体步骤">具体步骤
&lt;/h2>&lt;p>不讲原理，只说怎么用。原理可以去参考本博客其他文章。&lt;/p>
&lt;h3 id="1-购买机场梯子">1. 购买机场/梯子
&lt;/h3>&lt;ul>
&lt;li>推荐购买：&lt;a class="link" href="https://xminb.xiaomiaff.cc/register.html?invitecode=DBQFuexi" target="_blank" rel="noopener"
>五树云机场（原小米梯子）&lt;/a> 或 &lt;a class="link" href="https://ccv2.xiaojikp.pro/#/register?code=tqB3FCup" target="_blank" rel="noopener"
>小鸡快跑&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>其他机场可能需要&lt;strong>订阅转换&lt;/strong>才能在 &lt;a class="link" href="https://github.com/SagerNet/sing-box" target="_blank" rel="noopener"
>sing-box&lt;/a> 上使用。&lt;/p>
&lt;p>以下内容以 &lt;a class="link" href="https://ccv2.xiaojikp.pro/#/register?code=tqB3FCup" target="_blank" rel="noopener"
>小鸡快跑&lt;/a> 为例。&lt;/p>
&lt;p>注册后，选择&lt;code>购买订阅&lt;/code>购买，不同套餐一般都是流量不一样，按需购买。购买时间越长一般优惠越大，切合自己需求和经济能力购买。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/singbox-help-mobile/chickenrun-1.jpg"
width="2267"
height="1231"
srcset="https://www.wegod.cc/p/singbox-help-mobile/chickenrun-1_hu_f66645842ac2276.jpg 480w, https://www.wegod.cc/p/singbox-help-mobile/chickenrun-1_hu_e1f6c3cafadaa1a2.jpg 1024w"
loading="lazy"
alt="小鸡快跑购买订阅"
class="gallery-image"
data-flex-grow="184"
data-flex-basis="441px"
>&lt;/p>
&lt;p>购买完成后，回到&lt;code>仪表盘&lt;/code>，点击&lt;code>一键订阅&lt;/code>，再点击&lt;code>复制订阅地址&lt;/code>，保留好这个地址备用，一会儿再回来复制也行。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/singbox-help-mobile/chickenrun-2.jpg"
width="2267"
height="1238"
srcset="https://www.wegod.cc/p/singbox-help-mobile/chickenrun-2_hu_5aa24a934467036b.jpg 480w, https://www.wegod.cc/p/singbox-help-mobile/chickenrun-2_hu_1f6ad9442cd3af09.jpg 1024w"
loading="lazy"
alt="小鸡快跑订阅地址"
class="gallery-image"
data-flex-grow="183"
data-flex-basis="439px"
>&lt;/p>
&lt;h3 id="2-安装客户端软件">2. 安装客户端软件
&lt;/h3>&lt;p>本文推荐使用的是 &lt;a class="link" href="https://github.com/SagerNet/sing-box" target="_blank" rel="noopener"
>sing-box&lt;/a>，简单好用。&lt;/p>
&lt;p>安卓可以直接下载安装，iOS 需要&lt;strong>外区账号&lt;/strong>。&lt;/p>
&lt;h4 id="android-安装">Android 安装
&lt;/h4>&lt;p>Github 官方下载地址：&lt;a class="link" href="https://github.com/SagerNet/sing-box/releases" target="_blank" rel="noopener"
>https://github.com/SagerNet/sing-box/releases&lt;/a>&lt;/p>
&lt;p>请选择 &lt;code>SFA-{版本号}-universal.apk&lt;/code> 下载，因为不是从商店安装的，手机可能会提示风险，一直允许就行。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/singbox-help-mobile/singbox-dl.jpg"
width="1514"
height="559"
srcset="https://www.wegod.cc/p/singbox-help-mobile/singbox-dl_hu_e63440f63b9e91f2.jpg 480w, https://www.wegod.cc/p/singbox-help-mobile/singbox-dl_hu_9e70de680a6ac922.jpg 1024w"
loading="lazy"
alt="sing-box 下载"
class="gallery-image"
data-flex-grow="270"
data-flex-basis="650px"
>&lt;/p>
&lt;p>如果下载太慢，可以使用如下下载加速网站，右键复制链接后，贴到输入框里点击下载。&lt;/p>
&lt;p>Github 下载加速：&lt;a class="link" href="https://mirror.ghproxy.com/" target="_blank" rel="noopener"
>https://mirror.ghproxy.com/&lt;/a>&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/singbox-help-mobile/ghproxy.jpg"
width="2238"
height="911"
srcset="https://www.wegod.cc/p/singbox-help-mobile/ghproxy_hu_86cb6581f9d81b6.jpg 480w, https://www.wegod.cc/p/singbox-help-mobile/ghproxy_hu_2f57241e37fe3372.jpg 1024w"
loading="lazy"
alt="Github 下载加速"
class="gallery-image"
data-flex-grow="245"
data-flex-basis="589px"
>&lt;/p>
&lt;h4 id="ios-安装">iOS 安装
&lt;/h4>&lt;p>由于 iOS 的封闭性，软件只能从 APP Store 安装，然而由于某些不可说的原因，国区商店是没有的，所以只能换&lt;strong>非国区&lt;/strong>下载。&lt;/p>
&lt;h5 id="准备苹果外区账号">准备苹果外区账号
&lt;/h5>&lt;p>如果你有外区账号，可以跳过本节。&lt;/p>
&lt;p>如果你没有外区账号，自行注册外区账号比较复杂，推荐花 ￥6.6 直接购买一个，地区推荐选择美国。&lt;/p>
&lt;p>苹果外区账号购买：&lt;a class="link" href="https://www.bigplayers.com/shop/detail?id=77&amp;amp;inviteCode=A9245220" target="_blank" rel="noopener"
>https://www.bigplayers.com/shop/detail?id=77&amp;inviteCode=A9245220&lt;/a>&lt;/p>
&lt;p>用外区账号登录 APP Store，务必按下图操作，否则有导致手机被锁的风险：&lt;/p>
&lt;p>&lt;strong>一定不要使用购买的账号登录 iCloud ！！！&lt;/strong>
&lt;strong>一定不要使用购买的账号登录 iCloud ！！！&lt;/strong>
&lt;strong>一定不要使用购买的账号登录 iCloud ！！！&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;code>设置--&amp;gt;头像--&amp;gt;媒体购买与订阅&lt;/code>&lt;/li>
&lt;li>点击&lt;code>媒体购买与订阅&lt;/code>选择&lt;code>退出登录&lt;/code>&lt;/li>
&lt;li>再点击一次击&lt;code>媒体购买与订阅&lt;/code>选择&lt;code>不是xxx&lt;/code>，输入账号登录&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://www.wegod.cc/p/singbox-help-mobile/apple.jpg"
width="591"
height="1280"
srcset="https://www.wegod.cc/p/singbox-help-mobile/apple_hu_bf5b590ca31b09ad.jpg 480w, https://www.wegod.cc/p/singbox-help-mobile/apple_hu_fc8ed686bd50a262.jpg 1024w"
loading="lazy"
alt="苹果切换账号"
class="gallery-image"
data-flex-grow="46"
data-flex-basis="110px"
>&lt;/p>
&lt;h5 id="安装-sing-box">安装 sing-box
&lt;/h5>&lt;p>回到 APP Store，直接搜索 &lt;a class="link" href="https://apps.apple.com/us/app/sing-box/id6451272673" target="_blank" rel="noopener"
>sing-box&lt;/a> 安装即可。&lt;/p>
&lt;p>注意看下 Logo 和开发商，别下错了。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/singbox-help-mobile/singbox-app-store.jpg"
width="997"
height="390"
srcset="https://www.wegod.cc/p/singbox-help-mobile/singbox-app-store_hu_d21a6df7de51d21.jpg 480w, https://www.wegod.cc/p/singbox-help-mobile/singbox-app-store_hu_fa50d0842e17a3fb.jpg 1024w"
loading="lazy"
alt="苹果商店里的sing-box"
class="gallery-image"
data-flex-grow="255"
data-flex-basis="613px"
>&lt;/p>
&lt;h3 id="3-使用-sing-box">3. 使用 sing-box
&lt;/h3>&lt;p>iOS 和 Android 的界面有稍许差别。&lt;/p>
&lt;h4 id="android">Android
&lt;/h4>&lt;p>最下面选择 &lt;code>Profiles&lt;/code>，点击右下角添加图标，选择 &lt;code>Create Manually&lt;/code>。然后 Type 选择 &lt;code>Remote&lt;/code>，Name 可以任意填，URL 填入前面购买获取的订阅地址，最后点击 &lt;code>Create&lt;/code>。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/singbox-help-mobile/singbox-android-2.jpg"
width="1280"
height="900"
srcset="https://www.wegod.cc/p/singbox-help-mobile/singbox-android-2_hu_52d3774ea10895b8.jpg 480w, https://www.wegod.cc/p/singbox-help-mobile/singbox-android-2_hu_fd146dfd0c8a44aa.jpg 1024w"
loading="lazy"
alt="安卓添加订阅"
class="gallery-image"
data-flex-grow="142"
data-flex-basis="341px"
>&lt;/p>
&lt;p>回到 &lt;code>Dashboard&lt;/code>，选择刚刚创建的 Profile，点击右下角的三角启动。&lt;/p>
&lt;p>首次启动会提示添加 VPN，按提示允许即可。第一次启动时间较长，耐心等待一会儿，直到出现下面第二张图的界面即可使用了。&lt;/p>
&lt;p>启动后默认是&lt;strong>规则模式&lt;/strong>（Rule，国内外自动分流，可以一直开着不关闭）。节点是&lt;strong>自动选择&lt;/strong>，也可按需手动选择。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/singbox-help-mobile/singbox-android-3.jpg"
width="1280"
height="675"
srcset="https://www.wegod.cc/p/singbox-help-mobile/singbox-android-3_hu_ee66df7298d0ba8.jpg 480w, https://www.wegod.cc/p/singbox-help-mobile/singbox-android-3_hu_199ad6f3b5196ca2.jpg 1024w"
loading="lazy"
alt="安卓启动"
class="gallery-image"
data-flex-grow="189"
data-flex-basis="455px"
>&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/singbox-help-mobile/singbox-android-1.jpg"
width="606"
height="1280"
srcset="https://www.wegod.cc/p/singbox-help-mobile/singbox-android-1_hu_4daa79561bebefe6.jpg 480w, https://www.wegod.cc/p/singbox-help-mobile/singbox-android-1_hu_2511809323b5f655.jpg 1024w"
loading="lazy"
alt="安卓添加 VPN"
class="gallery-image"
data-flex-grow="47"
data-flex-basis="113px"
>&lt;/p>
&lt;h4 id="ios">iOS
&lt;/h4>&lt;p>iOS 需要先点击 &lt;code>Install Network Extension&lt;/code> 添加 VPN 到系统，如下图。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/singbox-help-mobile/singbox-ios-1.jpg"
width="591"
height="1280"
srcset="https://www.wegod.cc/p/singbox-help-mobile/singbox-ios-1_hu_88df9a8b18c1af6a.jpg 480w, https://www.wegod.cc/p/singbox-help-mobile/singbox-ios-1_hu_3a61c76bc26f044d.jpg 1024w"
loading="lazy"
alt="iOS 添加 VPN"
class="gallery-image"
data-flex-grow="46"
data-flex-basis="110px"
>&lt;/p>
&lt;p>最下面选择 &lt;code>Profiles&lt;/code>，点击 &lt;code>Create&lt;/code>。然后 Type 选择 &lt;code>Remote&lt;/code>，Name 可以任意填，URL 填入前面购买获取的订阅地址，最后点击 &lt;code>Create&lt;/code>。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/singbox-help-mobile/singbox-ios-2.jpg"
width="1280"
height="922"
srcset="https://www.wegod.cc/p/singbox-help-mobile/singbox-ios-2_hu_ac4198c4befcd920.jpg 480w, https://www.wegod.cc/p/singbox-help-mobile/singbox-ios-2_hu_61763c41167279ab.jpg 1024w"
loading="lazy"
alt="iOS 添加订阅"
class="gallery-image"
data-flex-grow="138"
data-flex-basis="333px"
>&lt;/p>
&lt;p>第一次启动时间较长，耐心等待一会儿，直到出现下面第二章图的界面即可使用了。&lt;/p>
&lt;p>启动后默认是&lt;strong>规则模式&lt;/strong>（Rule，国内外自动分流，可以一直开着不关闭）。节点是&lt;strong>自动选择&lt;/strong>，也可按需手动选择。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/singbox-help-mobile/singbox-ios-3.jpg"
width="1280"
height="692"
srcset="https://www.wegod.cc/p/singbox-help-mobile/singbox-ios-3_hu_ff7aa7ac6aac7f14.jpg 480w, https://www.wegod.cc/p/singbox-help-mobile/singbox-ios-3_hu_a559b6535f0009f8.jpg 1024w"
loading="lazy"
alt="iOS 启动"
class="gallery-image"
data-flex-grow="184"
data-flex-basis="443px"
>&lt;/p>
&lt;h2 id="接下来可以干什么">接下来可以干什么
&lt;/h2>&lt;p>至此，Google、Youtube、Telegram 等等你都可以访问了，总之，自由了！&lt;/p>
&lt;h2 id="最后">最后
&lt;/h2>&lt;p>有时候因为特殊原因，机场会刷新订阅地址，如果发现无法使用或者更新不了订阅，请到机场仪表盘重新复制新地址。&lt;/p>
&lt;p>👉: &lt;a class="link" href="https://www.wegod.cc/p/netflix-help/" >看境外流媒体（Netflix、Disney+ 等）的详细教程&lt;/a>&lt;/p></description></item><item><title>境外流媒体观看简单指南</title><link>https://www.wegod.cc/p/netflix-help/</link><pubDate>Sun, 19 May 2024 11:21:12 +0800</pubDate><guid>https://www.wegod.cc/p/netflix-help/</guid><description>&lt;img src="https://www.wegod.cc/p/netflix-help/cover.jpg" alt="Featured image of post 境外流媒体观看简单指南" />&lt;p>🔥🔥🔥：稳定好用的机场/梯子 &lt;a class="link" href="https://558343.dedicated-afflink.com/#/auth/2neqgxFl" target="_blank" rel="noopener"
>TAG 全球250+节点、99+流媒体解锁&lt;/a>，更多参考&lt;a class="link" href="https://www.wegod.cc/p/airport-recommend/" >机场推荐&lt;/a>&lt;/p>
&lt;hr>
&lt;p>Nextflix, Disney+ 和 Prime Vedio 是有中文字幕的，推荐在新加坡区观看，账号本身不分区，科学上网节点选择新加坡即可。&lt;/p>
&lt;h2 id="网络环境">网络环境
&lt;/h2>&lt;p>国外的大部分流媒体厂商，基本都禁止了大陆 IP，并且会检测 VPN。所以，一个能解锁流媒体的 VPN 是必备条件。&lt;/p>
&lt;p>目前大部分机场，基本都解锁了 Nextflix，其他的流媒体不是都解锁，购买时请注意下说明。&lt;a class="link" href="https://www.wegod.cc/p/airport-recommend/" >机场推荐&lt;/a>。&lt;/p>
&lt;p>手机科学上网教程可以参考：&lt;a class="link" href="https://www.wegod.cc/p/singbox-help-mobile/" >手把手教你科学上网 —— 手机篇（sing-box）&lt;/a>&lt;/p>
&lt;p>路由器科学上网教程可以参考：&lt;a class="link" href="https://www.wegod.cc/p/fuck-gfw/" >AGuardHome + mosdns + openclash 打造自由的家庭/办公室网络&lt;/a>&lt;/p>
&lt;h2 id="账号">账号
&lt;/h2>&lt;p>Nextflix 已经清退了大部分低价区用户，包括土区也无法使用了，在高价区自己订阅不划算，建议直接购买合租账号。&lt;/p>
&lt;p>这里推荐一个本人使用快四年的一个合租平台：&lt;a class="link" href="https://ihezu.zone/Ks3NUR" target="_blank" rel="noopener"
>奈飞小铺&lt;/a>&lt;/p>
&lt;p>都是平台作为号主的自营车，稳定可靠，9 折优惠码: &lt;code>letsfuckgfw&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/netflix-help/ihezu.jpg"
width="2560"
height="1194"
srcset="https://www.wegod.cc/p/netflix-help/ihezu_hu_9036561c41246709.jpg 480w, https://www.wegod.cc/p/netflix-help/ihezu_hu_57b70615dc9a0e3f.jpg 1024w"
loading="lazy"
alt="奈飞小铺"
class="gallery-image"
data-flex-grow="214"
data-flex-basis="514px"
>&lt;/p>
&lt;h2 id="客户端">客户端
&lt;/h2>&lt;p>网页观看也是可以的，直截了当。&lt;/p>
&lt;h3 id="ios">iOS
&lt;/h3>&lt;p>iOS 是需要外区账号的，获取外区账号可以参考：&lt;a class="link" href="https://www.wegod.cc/p/singbox-help-mobile/#%e5%87%86%e5%a4%87%e8%8b%b9%e6%9e%9c%e5%a4%96%e5%8c%ba%e8%b4%a6%e5%8f%b7" >手把手教你科学上网/准备外区账号&lt;/a>。&lt;/p>
&lt;p>使用外区账号下载对应客户端，用购买的合租账号登录即可。&lt;/p>
&lt;p>&lt;strong>友情提醒，千万别用购买的账号登录 iCloud，否则有手机被锁的风险！&lt;/strong>&lt;/p>
&lt;h3 id="安卓">安卓
&lt;/h3>&lt;h4 id="1-google-play-商店安装">1. Google Play 商店安装
&lt;/h4>&lt;p>推荐方式，先安装 谷歌框架 和 Google Play，然后在 Play 商店中安装。&lt;/p>
&lt;p>各个品牌手机安装谷歌框架，在 B 站都有教程，自己去搜下。&lt;/p>
&lt;h4 id="2-apk-安装">2. APK 安装
&lt;/h4>&lt;p>YouTube 和 Nextflix APK 安装后打开软件，可能还会提示需要谷歌框架。&lt;/p>
&lt;p>下载 APK 可以使用 &lt;a class="link" href="https://apkpure.com/cn/" target="_blank" rel="noopener"
>APKPure&lt;/a>、&lt;a class="link" href="https://www.apkmirror.com/" target="_blank" rel="noopener"
>APKMirror&lt;/a> 等。&lt;/p>
&lt;h3 id="电视端">电视端
&lt;/h3>&lt;h4 id="apple-tv">Apple TV
&lt;/h4>&lt;p>同 iOS 手机端一样，需要外区账号，且激活设备时必须使用外区账号，否则没有 APP Store。因此，如果要使用 Apple TV，建议注册一个自己的外区账号。&lt;/p>
&lt;p>Apple TV 无法安装国内视频平台软件。&lt;/p>
&lt;p>当然，决定买 Apple TV 的时候，所有的问题应该都考虑到了。&lt;/p>
&lt;h4 id="安卓盒子">安卓盒子
&lt;/h4>&lt;p>国产盒子看 Youtube 可以安装 &lt;a class="link" href="https://smarttubeapp.github.io/" target="_blank" rel="noopener"
>SmartTube&lt;/a>。&lt;/p>
&lt;p>国产电视盒子由于没有 Netflix 认证，即使安装了也看不了高清。&lt;/p>
&lt;p>所以建议直接购买境外版的电视盒子，通过 APK 安装国内视频平台软件，可以用得比较舒适。&lt;/p>
&lt;p>盒子的选择上推荐：&lt;/p>
&lt;ul>
&lt;li>Nvidia Shield TV: 有点贵，但是国内使用体验很好，虽然好几年没有出新，但是性能仍然过剩&lt;/li>
&lt;li>Chromecast GoogleTV&lt;/li>
&lt;li>小米盒子国际版&lt;/li>
&lt;li>FireTV&lt;/li>
&lt;/ul>
&lt;p>这些开机需要通过&lt;strong>谷歌账号&lt;/strong>激活，注册谷歌账号还是很容易的，但是此时还没进入系统不能安装软件，需要路由器能够科学上网才能正常激活。实在搞不定，购买的时候可以让店家帮忙激活，到手换成自己账号即可。&lt;/p></description></item><item><title>Vxlan 是否能让 GFW 放松一点？Vxlan 搭建科学上网实验</title><link>https://www.wegod.cc/p/fuck-gfw-vxlan/</link><pubDate>Fri, 01 Dec 2023 22:09:55 +0800</pubDate><guid>https://www.wegod.cc/p/fuck-gfw-vxlan/</guid><description>&lt;img src="https://www.wegod.cc/p/fuck-gfw-vxlan/cover.png" alt="Featured image of post Vxlan 是否能让 GFW 放松一点？Vxlan 搭建科学上网实验" />&lt;p>🔥🔥🔥：稳定好用的机场/梯子 &lt;a class="link" href="https://558343.dedicated-afflink.com/#/auth/2neqgxFl" target="_blank" rel="noopener"
>TAG 全球250+节点、99+流媒体解锁&lt;/a>，更多参考&lt;a class="link" href="https://www.wegod.cc/p/airport-recommend/" >机场推荐&lt;/a>&lt;/p>
&lt;hr>
&lt;p>VXLAN（Virtual eXtensible Local Area Network，虚拟扩展局域网），是由 IETF 定义的 NVO3（Network Virtualization over Layer 3）标准技术之一，是对传统 VLAN 协议的一种扩展。VXLAN 的特点是将 L2 的以太帧封装到 UDP 报文（即 L2 over L4）中，并在 L3 网络中传输。&lt;/p>
&lt;p>VXLAN 本质上是一种隧道技术，在源网络设备与目的网络设备之间的 IP 网络上，建立一条逻辑隧道，将用户侧报文经过特定的封装后通过这条隧道转发。&lt;/p>
&lt;p>关于 VXLAN，这里不展开讲，只需要知道两点：&lt;/p>
&lt;ol>
&lt;li>它是一种隧道技术&lt;/li>
&lt;li>它在公有云中被广泛应用&lt;/li>
&lt;/ol>
&lt;p>更深入的了解，可以参考&lt;a class="link" href="https://support.huawei.com/enterprise/zh/doc/EDOC1100087027" target="_blank" rel="noopener"
>什么是 VXLAN&lt;/a>。&lt;/p>
&lt;p>既然是隧道，就可以用它来整活儿。由于被公有云广泛应用，猜测 GFW 对它的审查应该有所放松。记得曾经在某公司云服务的一场会议上，听其高管讲，共有云的跨国流量里，80% 的流量都是非法业务。&lt;/p>
&lt;p>既如此，如果用 VXLAN 来科学上网，效果会不会不错？&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-txt" data-lang="txt">&lt;span class="line">&lt;span class="cl">先说结论吧：
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">- 直接把 VXLAN 作为隧道翻墙是不可行的，经测试，由于 VXLAN 并不加密，GFW 的审查应该是会剥离 VXLAN 头部直接审查内部报文。
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">- 所以，即使经过了 VXLAN 隧道，把 VPS 作为网关，访问情况和国内直接访问一致。
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="网络规划">网络规划
&lt;/h2>&lt;p>整体思路就是旁路由的思路，直接上图：&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/fuck-gfw-vxlan/network.jpg"
width="996"
height="307"
srcset="https://www.wegod.cc/p/fuck-gfw-vxlan/network_hu_df4b8f307eeae8d7.jpg 480w, https://www.wegod.cc/p/fuck-gfw-vxlan/network_hu_3046cdd7db5239f5.jpg 1024w"
loading="lazy"
alt="network"
class="gallery-image"
data-flex-grow="324"
data-flex-basis="778px"
>&lt;/p>
&lt;p>划重点：&lt;/p>
&lt;ol>
&lt;li>VXLAN 是要双向配置的，所以本地和远端都必须是公网IP。&lt;/li>
&lt;li>本地使用 RouterOS 7，当时起个 Liunx 也可以，用 ROS 主要是为了方便配置策略路由来分流。&lt;/li>
&lt;/ol>
&lt;h2 id="开始配置">开始配置
&lt;/h2>&lt;p>以下涉及到公网的 IP 的，使用 &lt;code>x&lt;/code> 替换了一部分，复制命令时请自行替换。&lt;/p>
&lt;p>这里是新拉起了一个 Linode VPS 作为远端服务器，系统使用的是 Ubuntu 22.04。&lt;/p>
&lt;h3 id="vps-准备工作">VPS 准备工作
&lt;/h3>&lt;h4 id="1-禁用防火墙">1. 禁用防火墙
&lt;/h4>&lt;p>既然是实验，先禁用防火墙，避免其可能的影响。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">systemctl stop ufw.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl disable ufw.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="2-开启转发">2. 开启转发
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">vim /etc/sysctl.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>取消以下两行的注释&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">net.ipv4.ip_forward=1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net.ipv6.conf.all.forwarding=1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>再执行&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sysctl -p
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="routeros-准备工作">RouterOS 准备工作
&lt;/h3>&lt;p>RouterOS 的配置就不截 winbox 配置界面的图了，命令行和界面基本都能对上，直接贴命令行了。&lt;/p>
&lt;h4 id="1-ip服务的安全策略先加上避免被爆破导致控制台疯狂输出登录失败日志">1. IP服务的安全策略先加上，避免被爆破，导致控制台疯狂输出登录失败日志
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">/ip service &lt;span class="nb">set&lt;/span> telnet &lt;span class="nv">address&lt;/span>&lt;span class="o">=&lt;/span>10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/ip service &lt;span class="nb">set&lt;/span> ftp &lt;span class="nv">address&lt;/span>&lt;span class="o">=&lt;/span>10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/ip service &lt;span class="nb">set&lt;/span> www &lt;span class="nv">address&lt;/span>&lt;span class="o">=&lt;/span>10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/ip service &lt;span class="nb">set&lt;/span> ssh &lt;span class="nv">address&lt;/span>&lt;span class="o">=&lt;/span>10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/ip service &lt;span class="nb">set&lt;/span> www-ssl &lt;span class="nv">address&lt;/span>&lt;span class="o">=&lt;/span>10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/ip service &lt;span class="nb">set&lt;/span> api &lt;span class="nv">address&lt;/span>&lt;span class="o">=&lt;/span>10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/ip service &lt;span class="nb">set&lt;/span> winbox &lt;span class="nv">address&lt;/span>&lt;span class="o">=&lt;/span>10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/ip service &lt;span class="nb">set&lt;/span> api-ssl &lt;span class="nv">address&lt;/span>&lt;span class="o">=&lt;/span>10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="2-配置上网这里是-pppoe-拨号">2. 配置上网，这里是 PPPOE 拨号
&lt;/h4>&lt;p>修改下接口名字&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">/interface ethernet &lt;span class="nb">set&lt;/span> &lt;span class="o">[&lt;/span> find default-name&lt;span class="o">=&lt;/span>ether1 &lt;span class="o">]&lt;/span> &lt;span class="nv">name&lt;/span>&lt;span class="o">=&lt;/span>ether1-wan
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/interface ethernet &lt;span class="nb">set&lt;/span> &lt;span class="o">[&lt;/span> find default-name&lt;span class="o">=&lt;/span>ether2 &lt;span class="o">]&lt;/span> &lt;span class="nv">name&lt;/span>&lt;span class="o">=&lt;/span>ether2-lan
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>配置 PPPOE&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">/interface pppoe-client add &lt;span class="nv">interface&lt;/span>&lt;span class="o">=&lt;/span>ether2-wan &lt;span class="nv">name&lt;/span>&lt;span class="o">=&lt;/span>pppoe-wan &lt;span class="nv">user&lt;/span>&lt;span class="o">=&lt;/span>&amp;lt;user&amp;gt; &lt;span class="nv">password&lt;/span>&lt;span class="o">=&lt;/span>&amp;lt;password&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>配置 DNS&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">/ip dns &lt;span class="nb">set&lt;/span> allow-remote-requests&lt;span class="o">=&lt;/span>yes &lt;span class="nv">servers&lt;/span>&lt;span class="o">=&lt;/span>223.5.5.5,114.114.114.114
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="配置检查">配置检查
&lt;/h3>&lt;h4 id="本地-ros-ping-vps">本地 ROS ping VPS
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@rostest&lt;span class="o">]&lt;/span> &amp;gt; ping 172.233.142.x
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> SEQ HOST SIZE TTL TIME STATUS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0&lt;/span> 172.233.142.x &lt;span class="m">56&lt;/span> &lt;span class="m">47&lt;/span> 184ms440us
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1&lt;/span> 172.233.142.x &lt;span class="m">56&lt;/span> &lt;span class="m">47&lt;/span> 184ms340us
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2&lt;/span> 172.233.142.x &lt;span class="m">56&lt;/span> &lt;span class="m">47&lt;/span> 184ms235us
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">sent&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">3&lt;/span> &lt;span class="nv">received&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">3&lt;/span> packet-loss&lt;span class="o">=&lt;/span>0% min-rtt&lt;span class="o">=&lt;/span>184ms235us avg-rtt&lt;span class="o">=&lt;/span>184ms338us max-rtt&lt;span class="o">=&lt;/span>184ms440u
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>可以看到网络是通的。&lt;/p>
&lt;h4 id="vps-ping-本地-ros-的公网-ip">VPS ping 本地 ROS 的公网 IP
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">root@localhost:~# ping 121.229.x.x
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PING 121.229.x.x &lt;span class="o">(&lt;/span>121.229.x.x&lt;span class="o">)&lt;/span> 56&lt;span class="o">(&lt;/span>84&lt;span class="o">)&lt;/span> bytes of data.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">64&lt;/span> bytes from 121.229.x.x: &lt;span class="nv">icmp_seq&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> &lt;span class="nv">ttl&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">40&lt;/span> &lt;span class="nv">time&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">186&lt;/span> ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">64&lt;/span> bytes from 121.229.x.x: &lt;span class="nv">icmp_seq&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2&lt;/span> &lt;span class="nv">ttl&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">40&lt;/span> &lt;span class="nv">time&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">186&lt;/span> ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">64&lt;/span> bytes from 121.229.x.x: &lt;span class="nv">icmp_seq&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">3&lt;/span> &lt;span class="nv">ttl&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">40&lt;/span> &lt;span class="nv">time&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">186&lt;/span> ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--- 121.229.x.x ping statistics ---
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">3&lt;/span> packets transmitted, &lt;span class="m">3&lt;/span> received, 0% packet loss, &lt;span class="nb">time&lt;/span> 2002ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rtt min/avg/max/mdev &lt;span class="o">=&lt;/span> 185.582/185.879/186.073/0.213 ms
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>可以看到网络是通的。&lt;/p>
&lt;h3 id="vxlan-vps-配置">VXLAN: VPS 配置
&lt;/h3>&lt;p>以下分别为命令行和 netplan 的配置。&lt;/p>
&lt;h4 id="命令行">命令行
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">ip link add vxlan0 &lt;span class="nb">type&lt;/span> vxlan &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> id &lt;span class="m">3000&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> remote 121.229.x.x &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> dstport &lt;span class="m">4789&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> &lt;span class="nb">local&lt;/span> 172.233.142.x &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> dev eth0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ip link &lt;span class="nb">set&lt;/span> vxlan0 up
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ip addr add 192.168.99.2/24 dev vxlan0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>查看 vxlan0 接口&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">root@localhost:~# ifconfig
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vxlan0: &lt;span class="nv">flags&lt;/span>&lt;span class="o">=&lt;/span>4163&amp;lt;UP,BROADCAST,RUNNING,MULTICAST&amp;gt; mtu &lt;span class="m">1450&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> inet 192.168.99.2 netmask 255.255.255.0 broadcast 0.0.0.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> inet6 fe80::ec90:6ff:fe88:372d prefixlen &lt;span class="m">64&lt;/span> scopeid 0x20&amp;lt;link&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ether ee:90:06:88:37:2d txqueuelen &lt;span class="m">1000&lt;/span> &lt;span class="o">(&lt;/span>Ethernet&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> RX packets &lt;span class="m">0&lt;/span> bytes &lt;span class="m">0&lt;/span> &lt;span class="o">(&lt;/span>0.0 B&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> RX errors &lt;span class="m">0&lt;/span> dropped &lt;span class="m">0&lt;/span> overruns &lt;span class="m">0&lt;/span> frame &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> TX packets &lt;span class="m">8&lt;/span> bytes &lt;span class="m">544&lt;/span> &lt;span class="o">(&lt;/span>544.0 B&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> TX errors &lt;span class="m">0&lt;/span> dropped &lt;span class="m">0&lt;/span> overruns &lt;span class="m">0&lt;/span> carrier &lt;span class="m">0&lt;/span> collisions &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>查看路由表，多了下面的内容，所有目的地址是 192.168.99.0/24 网络包要通过 vxlan0 转发：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">root@localhost:~# ip route show
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">192.168.99.0/24 dev vxlan0 proto kernel scope link src 192.168.99.2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>查看 fdb。这个表项的意思是，默认的 VTEP 对端地址为 121.229.x.x。换句话说，原始报文经过 vxlan0 后会被内核添加上 VXLAN 头部，而外部 UDP 头的目的 IP 地址会被冠上 121.229.x.x。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">root@localhost:~# bridge fdb show
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">00:00:00:00:00:00 dev vxlan0 dst 121.229.x.x via eth0 self permanent
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="netplan-配置文件">netplan 配置文件
&lt;/h4>&lt;p>命令行配置重启后会失效，放到 netplan 里配置持久化。&lt;/p>
&lt;p>&lt;code>/etc/netplan/99-vxlan-config.yaml&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">network&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">2&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">tunnels&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">vxlan0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">mode&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">vxlan&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">local&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">172.233.142&lt;/span>&lt;span class="l">.x&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">remote&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">121.229&lt;/span>&lt;span class="l">.x.x&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">id&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">3000&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">4789&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">addresses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="m">192.168.99.2&lt;/span>&lt;span class="l">/24&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="vxlan-本地-ros-配置">VXLAN: 本地 ROS 配置
&lt;/h3>&lt;p>先创建 VXLAN，然后再把 VXLAN 接口和 LAN 口桥接。&lt;/p>
&lt;h4 id="创建-vxlan">创建 VXLAN
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">/interface vxlan add &lt;span class="nv">name&lt;/span>&lt;span class="o">=&lt;/span>vxlan0 &lt;span class="nv">port&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">4789&lt;/span> &lt;span class="nv">vni&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">3000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/interface vxlan vteps add &lt;span class="nv">interface&lt;/span>&lt;span class="o">=&lt;/span>vxlan0 remote-ip&lt;span class="o">=&lt;/span>172.233.142.x
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="桥接-vxlan0-和-ether2-lan">桥接 vxlan0 和 ether2-lan
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">/interface bridge add &lt;span class="nv">name&lt;/span>&lt;span class="o">=&lt;/span>br-lan
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/interface bridge port add &lt;span class="nv">bridge&lt;/span>&lt;span class="o">=&lt;/span>br-lan &lt;span class="nv">interface&lt;/span>&lt;span class="o">=&lt;/span>ether2-lan
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/interface bridge port add &lt;span class="nv">bridge&lt;/span>&lt;span class="o">=&lt;/span>br-lan &lt;span class="nv">interface&lt;/span>&lt;span class="o">=&lt;/span>vxlan0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="br-lan-配置-ip">br-lan 配置 IP
&lt;/h4>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">/ip address add &lt;span class="nv">address&lt;/span>&lt;span class="o">=&lt;/span>192.168.99.1/24 &lt;span class="nv">interface&lt;/span>&lt;span class="o">=&lt;/span>br-lan &lt;span class="nv">network&lt;/span>&lt;span class="o">=&lt;/span>192.168.99.0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>这里配置的 IP 和 VPS 上给 vxlan0 接口配置的 IP 是相同网段的。&lt;/p>
&lt;h3 id="测试-vxlan-隧道">测试 VXLAN 隧道
&lt;/h3>&lt;p>在 VPS 上 ping ROS 的 br-lan 接口的 IP&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">root@localhost:~# ping 192.168.99.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PING 192.168.99.1 &lt;span class="o">(&lt;/span>192.168.99.1&lt;span class="o">)&lt;/span> 56&lt;span class="o">(&lt;/span>84&lt;span class="o">)&lt;/span> bytes of data.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">64&lt;/span> bytes from 192.168.99.1: &lt;span class="nv">icmp_seq&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> &lt;span class="nv">ttl&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">64&lt;/span> &lt;span class="nv">time&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">144&lt;/span> ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">64&lt;/span> bytes from 192.168.99.1: &lt;span class="nv">icmp_seq&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2&lt;/span> &lt;span class="nv">ttl&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">64&lt;/span> &lt;span class="nv">time&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">144&lt;/span> ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">64&lt;/span> bytes from 192.168.99.1: &lt;span class="nv">icmp_seq&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">3&lt;/span> &lt;span class="nv">ttl&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">64&lt;/span> &lt;span class="nv">time&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">144&lt;/span> ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--- 192.168.99.1 ping statistics ---
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">3&lt;/span> packets transmitted, &lt;span class="m">3&lt;/span> received, 0% packet loss, &lt;span class="nb">time&lt;/span> 2003ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rtt min/avg/max/mdev &lt;span class="o">=&lt;/span> 144.359/144.400/144.446/0.035 ms
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在 ROS 上 ping VPS 的 vxlan0 接口的 IP&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@rostest&lt;span class="o">]&lt;/span> &amp;gt; ping 192.168.99.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> SEQ HOST SIZE TTL TIME STATUS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0&lt;/span> 192.168.99.2 &lt;span class="m">56&lt;/span> &lt;span class="m">64&lt;/span> 144ms271us
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1&lt;/span> 192.168.99.2 &lt;span class="m">56&lt;/span> &lt;span class="m">64&lt;/span> 144ms647us
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2&lt;/span> 192.168.99.2 &lt;span class="m">56&lt;/span> &lt;span class="m">64&lt;/span> 144ms309us
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">sent&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">3&lt;/span> &lt;span class="nv">received&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">3&lt;/span> packet-loss&lt;span class="o">=&lt;/span>0% min-rtt&lt;span class="o">=&lt;/span>144ms271us g-rtt&lt;span class="o">=&lt;/span>144ms409us max-rtt&lt;span class="o">=&lt;/span>144ms647us
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>可以看到，VXLAN 已经互通了。&lt;/p>
&lt;p>在 VPS 上再查看一下 fdb，可以看到，本地网络的一些 MAC 地址已经学习过来了，摘取了部分：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">00:00:00:00:00:00 dev vxlan0 dst 121.229.x.x self permanent
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ac:82:26:xx:xx:xx dev vxlan0 dst 121.229.x.x self
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">26:99:ac:xx:xx:xx dev vxlan0 dst 121.229.x.x self
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">98:3f:60:xx:xx:xx dev vxlan0 dst 121.229.x.x self
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="在-vps-上配置-snat">在 VPS 上配置 snat
&lt;/h3>&lt;p>源地址 NAT 不多说了，不明白的自己查。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">iptables -t nat &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -A POSTROUTING &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -s 192.168.99.0/24 &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -o eth0 &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -j SNAT &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> --to-source 172.233.142.x
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>配置完查看下，确保配置成功&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">root@localhost:~# iptables -nL -t nat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Chain POSTROUTING &lt;span class="o">(&lt;/span>policy ACCEPT&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">target prot opt &lt;span class="nb">source&lt;/span> destination
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SNAT all -- 192.168.99.0/24 0.0.0.0/0 to:172.233.142.x
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="pc-上网测试">PC 上网测试
&lt;/h2>&lt;p>把本地电脑的网络配置成：&lt;/p>
&lt;ul>
&lt;li>地址: 192.168.99.200&lt;/li>
&lt;li>掩码: 255.255.255.0&lt;/li>
&lt;li>网关: 192.168.99.2&lt;/li>
&lt;li>DNS: 8.8.8.8&lt;/li>
&lt;/ul>
&lt;p>在 VPS 上 ping 一下 &lt;code>192.168.99.200&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">root@localhost:~# ping 192.168.99.200
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PING 192.168.99.200 &lt;span class="o">(&lt;/span>192.168.99.200&lt;span class="o">)&lt;/span> 56&lt;span class="o">(&lt;/span>84&lt;span class="o">)&lt;/span> bytes of data.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">64&lt;/span> bytes from 192.168.99.200: &lt;span class="nv">icmp_seq&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> &lt;span class="nv">ttl&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">128&lt;/span> &lt;span class="nv">time&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">145&lt;/span> ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">64&lt;/span> bytes from 192.168.99.200: &lt;span class="nv">icmp_seq&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2&lt;/span> &lt;span class="nv">ttl&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">128&lt;/span> &lt;span class="nv">time&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">144&lt;/span> ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">64&lt;/span> bytes from 192.168.99.200: &lt;span class="nv">icmp_seq&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">3&lt;/span> &lt;span class="nv">ttl&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">128&lt;/span> &lt;span class="nv">time&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">143&lt;/span> ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--- 192.168.99.200 ping statistics ---
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">3&lt;/span> packets transmitted, &lt;span class="m">3&lt;/span> received, 0% packet loss, &lt;span class="nb">time&lt;/span> 1998ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rtt min/avg/max/mdev &lt;span class="o">=&lt;/span> 143.159/144.091/144.858/0.703 ms
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>可以看到，VPS 和本地 PC 已经连通，并且还是相同网段的二层域。&lt;/p>
&lt;p>打开浏览器，打开 &lt;a class="link" href="https://ip.skk.moe/" target="_blank" rel="noopener"
>https://ip.skk.moe/&lt;/a> 测试下。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/fuck-gfw-vxlan/test-result.jpg"
width="888"
height="819"
srcset="https://www.wegod.cc/p/fuck-gfw-vxlan/test-result_hu_23bb33438e0f0331.jpg 480w, https://www.wegod.cc/p/fuck-gfw-vxlan/test-result_hu_38c0b15725f2c2e8.jpg 1024w"
loading="lazy"
alt="test-result"
class="gallery-image"
data-flex-grow="108"
data-flex-basis="260px"
>&lt;/p>
&lt;p>从图中可知，IP 地址已经是 VPS 的公网IP，但是访问阻断情况和国内直接访问一致，并且还额外导致百度无法访问。&lt;/p>
&lt;p>再次测试，例如 Apple 等未被 GFW 封锁的网站都是可以正常访问的。&lt;/p>
&lt;p>&lt;img src="https://www.wegod.cc/p/fuck-gfw-vxlan/Apple.jpg"
width="1352"
height="824"
srcset="https://www.wegod.cc/p/fuck-gfw-vxlan/Apple_hu_e7a9388e0198f783.jpg 480w, https://www.wegod.cc/p/fuck-gfw-vxlan/Apple_hu_f628914690908ee6.jpg 1024w"
loading="lazy"
alt="Apple"
class="gallery-image"
data-flex-grow="164"
data-flex-basis="393px"
>&lt;/p>
&lt;p>由此可见：由于 VXLAN 并不加密，GFW 的审查应该是会剥离 VXLAN 头部直接审查内部报文，所以访问阻断的结果和国内一致。&lt;/p>
&lt;h2 id="结论">结论
&lt;/h2>&lt;ol>
&lt;li>GFW 对 VXLAN 并不会放松审查，但是猜测：VXLAN 报文中含有被阻断的域名、IP，并不会直接导致 GFW 封锁 VPS 的 IP。&lt;/li>
&lt;li>由第1点，或许可以采用 VXLAN 报文作为外层包装，从而达到保护 VPS IP 的目的。毕竟各大机场基本都是通过国内公有云中转，而中转流量很大一部分应该跑在 VXLAN 之上。&lt;/li>
&lt;li>VXLAN 对性能的损失非常小，但由于 VXLAN 的配置需要双向公网 IP，没有公网 IP 的情况下，使用起来有两个思路：
&lt;ol>
&lt;li>作为外层包装协议，并不实际创建 VXLAN 隧道；&lt;/li>
&lt;li>使用国内公有云中转，国内外 VPS 直接配置 VXLAN 隧道；&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ol></description></item></channel></rss>